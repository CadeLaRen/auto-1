<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.Auto.Effects</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-Auto-Effects.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">auto-0.1.0.0: Locally stateful programming with denotational semantics.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(c) Justin Le 2014</td></tr><tr><th>License</th><td>MIT</td></tr><tr><th>Maintainer</th><td>justin@jle.im</td></tr><tr><th>Stability</th><td>unstable</td></tr><tr><th>Portability</th><td>portable</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Control.Auto.Effects</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Running effects</a><ul><li><a href="#g:2">Continually</a></li><li><a href="#g:3">From inputs</a></li><li><a href="#g:4">On <code>Blip</code>s</a></li></ul></li><li><a href="#g:5">One-time effects</a></li><li><a href="#g:6">&quot;Sealing off&quot; monadic <code>Auto</code>s</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module exports the preferred ways of interacting with the
 underlying <code><a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a></code> of the <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code> type, including accessing, executing,
 and manipulating such effects.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:arrM">arrM</a> ::  (a -&gt; m b) -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:effect">effect</a> ::  m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:exec">exec</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a a</li><li class="src short"><a href="#v:effects">effects</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (m a) a</li><li class="src short"><a href="#v:arrMB">arrMB</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; (a -&gt; m b) -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a) (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> b)</li><li class="src short"><a href="#v:effectB">effectB</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a) (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> b)</li><li class="src short"><a href="#v:execB">execB</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a) (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a)</li><li class="src short"><a href="#v:cache">cache</a> :: (<a href="file:///home/justin/projects/haskell/auto/.cabal-sandbox/share/doc/x86_64-linux-ghc-7.8.3/cereal-0.4.1.1/html/Data-Serialize.html#t:Serialize">Serialize</a> b, <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m) =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:execOnce">execOnce</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a ()</li><li class="src short"><a href="#v:cache_">cache_</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:execOnce_">execOnce_</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a ()</li><li class="src short"><a href="#v:sealState">sealState</a> :: (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m, <a href="file:///home/justin/projects/haskell/auto/.cabal-sandbox/share/doc/x86_64-linux-ghc-7.8.3/cereal-0.4.1.1/html/Data-Serialize.html#t:Serialize">Serialize</a> s) =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-State-Lazy.html#t:StateT">StateT</a> s m) a b -&gt; s -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:sealState_">sealState_</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-State-Lazy.html#t:StateT">StateT</a> s m) a b -&gt; s -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:sealReader">sealReader</a> :: (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m, <a href="file:///home/justin/projects/haskell/auto/.cabal-sandbox/share/doc/x86_64-linux-ghc-7.8.3/cereal-0.4.1.1/html/Data-Serialize.html#t:Serialize">Serialize</a> r) =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-Reader.html#t:ReaderT">ReaderT</a> r m) a b -&gt; r -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li><li class="src short"><a href="#v:sealReader_">sealReader_</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-Reader.html#t:ReaderT">ReaderT</a> r m) a b -&gt; r -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</li></ul></div><div id="interface"><h1 id="g:1">Running effects</h1><h2 id="g:2">Continually</h2><div class="top"><p class="src"><a name="v:arrM" class="def">arrM</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (a -&gt; m b)</td><td class="doc"><p>monadic function</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Lifts a &quot;monadic function&quot; (Kleisli arrow) into an <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code>.  Like
 <code>arr</code>, but with monadic functions.  Composition of such <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code>s works
 just like the composition of Kleisli arrows, with '(&lt;=&lt;)':</p><pre>arrM f . arrM g == arrM (f &lt;=&lt; g)</pre></div></div><div class="top"><p class="src"><a name="v:effect" class="def">effect</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: m b</td><td class="doc"><p>monadic action to contually execute.</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><a href="Executes.html">Executes</a> the given monadic action at every tick/step of the <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code>,
 outputting the result.  Particularly useful with <code>Reader</code> as the
 underlying <code><a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a></code>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let a = effect ask     :: Auto (Reader b) a b
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let r = evalAuto a ()  :: Reader b b
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>runReader r &quot;hello&quot;
</code></strong>&quot;hello&quot;
<code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>runReader r 123
</code></strong>123
</pre><p>Basically like <code><a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Applicative.html#v:pure">pure</a></code>, but instead of `pure :: b -&gt; Auto m a b`, you
 have `effect :: m b -&gt; Auto m a b`.</p></div></div><div class="top"><p class="src"><a name="v:exec" class="def">exec</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; m b</td><td class="doc"><p>monadic action to contually execute.</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><a href="Executes.html">Executes</a> the given monadic action at every tick/step of the <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code>,
 but ignores the result.  Basically acts like the <code><a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Category.html#v:id">id</a></code> <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code>, with
 attached effects.</p></div></div><h2 id="g:3">From inputs</h2><div class="top"><p class="src"><a name="v:effects" class="def">effects</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (m a) a</p><div class="doc"><p>Gets an input stream of monadic actions, executes them, and returns an
 output stream of their values.</p></div></div><h2 id="g:4">On <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code>s</h2><div class="top"><p class="src"><a name="v:arrMB" class="def">arrMB</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; (a -&gt; m b) -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a) (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> b)</p><div class="doc"><p>Applies the &quot;monadic function&quot; to the contents of every incoming
 <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code>, and replaces the contents of the <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code> with the result of the
 function.</p></div></div><div class="top"><p class="src"><a name="v:effectB" class="def">effectB</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a) (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> b)</p><div class="doc"><p>Executes a monadic action with every incoming <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code>, and replaces the
 contents of the <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code> with the result of the action.</p></div></div><div class="top"><p class="src"><a name="v:execB" class="def">execB</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; m b -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a) (<a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a> a)</p><div class="doc"><p>Executes a monadic action with every incoming <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code>, and passes back
 that same <code><a href="Control-Auto-Blip-Internal.html#t:Blip">Blip</a></code> unchanged.</p></div></div><h1 id="g:5">One-time effects</h1><div class="top"><p class="src"><a name="v:cache" class="def">cache</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///home/justin/projects/haskell/auto/.cabal-sandbox/share/doc/x86_64-linux-ghc-7.8.3/cereal-0.4.1.1/html/Data-Serialize.html#t:Serialize">Serialize</a> b, <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; m b</td><td class="doc"><p>monadic action to execute and use the result of</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><a href="Executes.html">Executes</a> a monadic action once (and only once), and continues to
 echo the result forevermore.</p><p>Like <code><a href="Control-Auto-Effects.html#v:execOnce">execOnce</a></code>, exept outputs the result of the action.</p><p>Useful for loading resources in IO on the &quot;first step&quot;, like
 a dictionary:</p><pre>dictionary :: Auto IO a [String]
dictionary = cache (lines <a href="$">$</a> readFile &quot;dictionary.txt&quot;)
</pre></div></div><div class="top"><p class="src"><a name="v:execOnce" class="def">execOnce</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; m b</td><td class="doc"><p>monadic action to execute; result discared</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p><a href="Executes.html">Executes</a> the monadic action once, and outputs '()' forevermore.</p><p>Pretty much like <code><a href="Control-Auto-Effects.html#v:cache">cache</a></code>, but always outputs '()'.</p></div></div><div class="top"><p class="src"><a name="v:cache_" class="def">cache_</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; m b</td><td class="doc"><p>monadic action to execute and use the result of</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>The non-resumable/non-serializable version of <code><a href="Control-Auto-Effects.html#v:cache">cache</a></code>.  Every time the
 <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code> is deserialized/reloaded, it re-executes the action to retrieve
 the result again.</p><p>Useful in cases where you want to &quot;re-load&quot; an expensive resource on
 every startup, instead of saving it to in the save states.</p><pre>dictionary :: Auto IO a [String]
dictionary = cache_ (lines <a href="$">$</a> readFile &quot;dictionary.txt&quot;)
</pre></div></div><div class="top"><p class="src"><a name="v:execOnce_" class="def">execOnce_</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; m b</td><td class="doc"><p>monadic action to execute; result discared</p></td></tr><tr><td class="src">-&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>The non-resumable/non-serializable version of <code><a href="Control-Auto-Effects.html#v:execOnce">execOnce</a></code>.  Every time
 the <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code> is deserialized/reloaded, the action is re-executed again.</p></div></div><h1 id="g:6">&quot;Sealing off&quot; monadic <code><a href="Control-Auto-Core.html#t:Auto">Auto</a></code>s</h1><div class="top"><p class="src"><a name="v:sealState" class="def">sealState</a> :: (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m, <a href="file:///home/justin/projects/haskell/auto/.cabal-sandbox/share/doc/x86_64-linux-ghc-7.8.3/cereal-0.4.1.1/html/Data-Serialize.html#t:Serialize">Serialize</a> s) =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-State-Lazy.html#t:StateT">StateT</a> s m) a b -&gt; s -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</p></div><div class="top"><p class="src"><a name="v:sealState_" class="def">sealState_</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-State-Lazy.html#t:StateT">StateT</a> s m) a b -&gt; s -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</p></div><div class="top"><p class="src"><a name="v:sealReader" class="def">sealReader</a> :: (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m, <a href="file:///home/justin/projects/haskell/auto/.cabal-sandbox/share/doc/x86_64-linux-ghc-7.8.3/cereal-0.4.1.1/html/Data-Serialize.html#t:Serialize">Serialize</a> r) =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-Reader.html#t:ReaderT">ReaderT</a> r m) a b -&gt; r -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</p></div><div class="top"><p class="src"><a name="v:sealReader_" class="def">sealReader_</a> :: <a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/base-4.7.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> (<a href="file:///usr/local/ghc-7.8.3/share/doc/ghc/html/libraries/transformers-0.3.0.0/Control-Monad-Trans-Reader.html#t:ReaderT">ReaderT</a> r m) a b -&gt; r -&gt; <a href="Control-Auto-Core.html#t:Auto">Auto</a> m a b</p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.14.3</p></div></body></html>